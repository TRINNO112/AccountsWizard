<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accounts Wizard AI - Your Personal Accounting Tutor</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='96' height='96' viewBox='0 0 24 24'%3E%3Cpath fill='%23fff' d='M7 3h10a2 2 0 0 1 2 2v2H5V5a2 2 0 0 1 2-2m12 6v8a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V9z'/%3E%3Cpath fill='%23a5b4fc' d='M8.5 12h7v1.6h-7zM8.5 15h5v1.6h-5z'/%3E%3C/svg%3E" />
    <style>
        /* ==================== RESET & VARIABLES ==================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #111111;
            --bg-card: #151515;
            --bg-tertiary: #1a1a1a;
            
            --accent-green: #00ff88;
            --accent-blue: #00d4ff;
            --accent-purple: #a855f7;
            --accent-gold: #ffd700;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-muted: #666666;
            
            --border: #252525;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            --glow: 0 0 20px rgba(0, 255, 136, 0.3);
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            height: 90vh;
        }

        /* ==================== ANIMATED BACKGROUND ==================== */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: 
                radial-gradient(circle at 20% 30%, rgba(0, 255, 136, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.05) 0%, transparent 50%);
            animation: bgPulse 15s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Grid overlay */
        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background-image: 
                linear-gradient(var(--border) 1px, transparent 1px),
                linear-gradient(90deg, var(--border) 1px, transparent 1px);
            background-size: 50px 50px;
            opacity: 0.02;
        }

        /* ==================== TOP HEADER ==================== */
        .top-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: rgba(17, 17, 17, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            box-shadow: var(--shadow);
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: var(--glow);
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .brand {
            display: flex;
            flex-direction: column;
        }

        .brand-name {
            font-size: 20px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .brand-tagline {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .header-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }

        .header-btn:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
            transform: translateY(-2px);
        }

        .back-btn {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: var(--bg-primary);
            border: none;
            padding: 10px 24px;
            box-shadow: var(--glow);
        }

        .back-btn:hover {
            transform: translateY(-2px) scale(1.05);
        }

        /* ==================== MAIN LAYOUT - UPDATED FOR FIXED CHAT ==================== */
        .main-container {
            display: grid;
            grid-template-columns: 1fr 320px;
            height: calc(100vh - 70px);
            margin-top: 70px;
            width: 100%;
            overflow: hidden;
            gap: 0;
        }

        /* ==================== CHAT CONTAINER - FIXED ==================== */
        .chat-container {
            background: var(--bg-card);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        /* Chat Header */
        .chat-header {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 212, 255, 0.05));
            border-bottom: 1px solid var(--border);
            padding: 25px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .ai-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .ai-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 0 25px rgba(0, 255, 136, 0.4);
            animation: avatarGlow 3s ease-in-out infinite;
        }

        @keyframes avatarGlow {
            0%, 100% { box-shadow: 0 0 25px rgba(0, 255, 136, 0.4); }
            50% { box-shadow: 0 0 35px rgba(0, 255, 136, 0.6); }
        }

        .ai-details {
            flex: 1;
        }

        .ai-name {
            font-size: 22px;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .ai-status {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            color: var(--text-secondary);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        .chat-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 18px;
        }

        .action-btn:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--accent-green);
            transform: translateY(-2px);
        }

        /* Messages Area */
        .messages-area {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            background: var(--bg-secondary);
            scroll-behavior: smooth;
        }

        .messages-area::-webkit-scrollbar {
            width: 8px;
        }

        .messages-area::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        .messages-area::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--accent-green), var(--accent-blue));
            border-radius: 10px;
        }

        /* Welcome Screen */
        .welcome-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px;
        }

        .welcome-icon {
            font-size: 80px;
            margin-bottom: 25px;
            animation: welcomeFloat 3s ease-in-out infinite;
        }

        @keyframes welcomeFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        .welcome-title {
            font-size: 36px;
            font-weight: 900;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .welcome-text {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: 30px;
            line-height: 1.8;
            max-width: 600px;
        }

        .welcome-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 600px;
            margin-bottom: 30px;
        }

        .feature-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: left;
            transition: all 0.3s ease;
        }

        .feature-box:hover {
            background: rgba(0, 255, 136, 0.05);
            border-color: var(--accent-green);
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 28px;
            margin-bottom: 10px;
            display: block;
        }

        .feature-name {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .feature-desc {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .start-btn {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: var(--bg-primary);
            border: none;
            padding: 14px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: var(--glow);
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        /* ==================== MESSAGE BUBBLES ==================== */
        .message-wrapper {
            margin-bottom: 25px;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message {
            display: flex;
            gap: 12px;
            max-width: 85%;
        }

        .message.user {
            flex-direction: row-reverse;
            margin-left: auto;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, var(--accent-purple), #ec4899);
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.4);
        }

        .message.ai .message-avatar {
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        .message-content {
            flex: 1;
        }

        .message-bubble {
            padding: 16px 20px;
            border-radius: 16px;
            line-height: 1.7;
            font-size: 15px;
            word-wrap: break-word;
        }

        .message.user .message-bubble {
            background: rgba(168, 85, 247, 0.15);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-bottom-right-radius: 4px;
        }

        .message.ai .message-bubble {
            background: rgba(0, 255, 136, 0.08);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-bottom-left-radius: 4px;
        }

        .message-bubble strong {
            color: var(--accent-green);
            font-weight: 700;
        }

        .message-bubble em {
            color: var(--accent-blue);
        }

        .message-bubble code {
            background: rgba(0, 0, 0, 0.4);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            color: var(--accent-gold);
        }

        .message-time {
            font-size: 11px;
            color: var(--text-muted);
            margin-top: 6px;
        }

        .message.user .message-time {
            text-align: right;
        }

        /* Typing Indicator */
        .typing-indicator {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 16px 20px;
            background: rgba(0, 255, 136, 0.08);
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 16px;
            border-bottom-left-radius: 4px;
            max-width: fit-content;
        }

        .typing-dots {
            display: flex;
            gap: 5px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: var(--accent-green);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
            30% { transform: translateY(-8px); opacity: 1; }
        }

        .typing-text {
            font-size: 13px;
            color: var(--text-secondary);
            font-style: italic;
        }

        /* ==================== CHAT INPUT ==================== */
        .chat-input-area {
            border-top: 1px solid var(--border);
            background: var(--bg-card);
            padding: 20px 25px;
            flex-shrink: 0;
        }

        .suggested-questions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .suggested-questions::-webkit-scrollbar {
            height: 4px;
        }

        .suggested-questions::-webkit-scrollbar-thumb {
            background: var(--accent-green);
            border-radius: 10px;
        }

        .suggestion-chip {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .suggestion-chip:hover {
            background: rgba(0, 255, 136, 0.1);
            border-color: var(--accent-green);
            color: var(--accent-green);
            transform: translateY(-2px);
        }

        .input-container {
            display: flex;
            gap: 12px;
            align-items: flex-end;
        }

        .input-wrapper {
            flex: 1;
            position: relative;
        }

        #userInput {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--border);
            border-radius: 14px;
            padding: 14px 20px;
            color: var(--text-primary);
            font-size: 15px;
            font-family: 'Inter', sans-serif;
            resize: none;
            min-height: 50px;
            max-height: 150px;
            transition: all 0.3s ease;
        }

        #userInput:focus {
            outline: none;
            border-color: var(--accent-green);
            background: rgba(0, 255, 136, 0.05);
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.15);
        }

        #userInput::placeholder {
            color: var(--text-muted);
        }

        .send-btn {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: var(--glow);
            z-index: 2;
        }

        .send-btn:hover {
            transform: scale(1.1) rotate(15deg);
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        /* ==================== RIGHT SIDEBAR - SCROLLABLE ==================== */
        .right-sidebar {
            background: var(--bg-card);
            border-left: 1px solid var(--border);
            height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 25px;
        }

        .right-sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .right-sidebar::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        .right-sidebar::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, var(--accent-green), var(--accent-blue));
            border-radius: 10px;
        }

        /* AI Profile Card */
        .ai-profile-card {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.1), rgba(0, 212, 255, 0.05));
            border: 1px solid rgba(0, 255, 136, 0.2);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            margin-bottom: 25px;
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 15px;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.4);
        }

        .profile-name {
            font-size: 18px;
            font-weight: 800;
            margin-bottom: 8px;
        }

        .profile-description {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .profile-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            justify-content: center;
        }

        .tag {
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            color: var(--accent-green);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        /* Stats Section */
        .sidebar-section {
            margin-bottom: 25px;
        }

        .section-header {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-muted);
            margin-bottom: 15px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 25px;
        }

        .stat-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-box:hover {
            border-color: var(--accent-green);
            transform: translateY(-3px);
            box-shadow: var(--glow);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: block;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Quick Topics */
        .topic-btn {
            width: 100%;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            padding: 12px 15px;
            border-radius: 10px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .topic-btn:hover {
            background: rgba(0, 255, 136, 0.08);
            border-color: var(--accent-green);
            color: var(--text-primary);
            transform: translateX(5px);
        }

        .topic-icon {
            font-size: 18px;
        }

        /* Achievements */
        .achievement-item {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s ease;
        }

        .achievement-item.locked {
            opacity: 0.4;
        }

        .achievement-item.unlocked {
            background: rgba(255, 215, 0, 0.08);
            border-color: var(--accent-gold);
        }

        .achievement-item:hover {
            transform: scale(1.02);
        }

        .achievement-icon {
            font-size: 28px;
            filter: grayscale(100%);
        }

        .achievement-item.unlocked .achievement-icon {
            filter: grayscale(0);
            animation: pop 0.6s ease;
        }

        @keyframes pop {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3) rotate(10deg); }
        }

        .achievement-info {
            flex: 1;
        }

        .achievement-title {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 3px;
        }

        .achievement-item.unlocked .achievement-title {
            color: var(--accent-gold);
        }

        .achievement-desc {
            font-size: 11px;
            color: var(--text-secondary);
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .quick-action {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .quick-action:hover {
            background: rgba(0, 255, 136, 0.08);
            border-color: var(--accent-green);
            transform: translateY(-3px);
        }

        .quick-action-icon {
            font-size: 24px;
            margin-bottom: 6px;
            display: block;
        }

        .quick-action-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* ==================== RESPONSIVE DESIGN ==================== */
        @media (max-width: 1200px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .right-sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .top-header {
                height: 65px;
                padding: 0 15px;
            }

            .brand-name {
                font-size: 16px;
            }

            .brand-tagline {
                display: none;
            }

            .header-btn span {
                display: none;
            }

            .header-btn {
                padding: 10px;
            }

            .main-container {
                margin-top: 65px;
                height: calc(100vh - 65px);
            }

            .chat-header {
                padding: 20px 15px;
            }

            .ai-avatar {
                width: 50px;
                height: 50px;
                font-size: 28px;
            }

            .ai-name {
                font-size: 18px;
            }

            .messages-area {
                padding: 20px 15px;
            }

            .welcome-title {
                font-size: 28px;
            }

            .welcome-icon {
                font-size: 60px;
            }

            .welcome-features {
                grid-template-columns: 1fr;
            }

            .message {
                max-width: 95%;
            }

            .suggested-questions {
                flex-direction: column;
            }

            .chat-input-area {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .welcome-screen {
                padding: 20px;
            }

            .welcome-title {
                font-size: 24px;
            }

            .welcome-text {
                font-size: 14px;
            }

            .feature-box {
                padding: 15px;
            }

            .message-bubble {
                padding: 12px 16px;
                font-size: 14px;
            }
        }

        /* ==================== UTILITY CLASSES ==================== */
        .hidden {
            display: none !important;
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Print Styles */
        @media print {
            .top-header,
            .right-sidebar,
            .chat-input-area,
            .chat-actions {
                display: none !important;
            }

            .main-container {
                grid-template-columns: 1fr;
                margin: 0;
                padding: 20px;
                height: auto;
            }

            .chat-container {
                height: auto;
                border: none;
            }

            .messages-area {
                background: white;
                color: black;
                overflow: visible;
            }
        }
    </style>
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    <div class="grid-overlay"></div>

    <!-- Top Header -->
    <header class="top-header">
        <div class="logo-section">
            <div class="logo">üßô</div>
            <div class="brand">
                <div class="brand-name">Accounts Wizard AI</div>
                <div class="brand-tagline">Your Accounting Assistant</div>
            </div>
        </div>
        <div class="header-actions">
            <button class="header-btn" onclick="clearChat()">
                <span>üóëÔ∏è</span>
                <span>Clear</span>
            </button>
            <button class="header-btn" onclick="exportChat()">
                <span>üì•</span>
                <span>Export</span>
            </button>
            <a href="index.html" class="header-btn back-btn">
                <span>‚Üê</span>
                <span>Back</span>
            </a>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Chat Container -->
        <div class="chat-container">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="ai-info">
                    <div class="ai-avatar">üßô</div>
                    <div class="ai-details">
                        <h2 class="ai-name">Accounts Wizard</h2>
                        <div class="ai-status">
                            <span class="status-dot"></span>
                            <span>Online & Ready to Help</span>
                        </div>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="action-btn" onclick="downloadChat()" title="Download">üíæ</button>
                    <button class="action-btn" onclick="shareChat()" title="Share">üì§</button>
                </div>
            </div>

            <!-- Messages Area -->
            <div class="messages-area" id="messagesArea">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-icon">üßô‚Äç‚ôÇÔ∏è‚ú®</div>
                    <h1 class="welcome-title">Welcome to Accounts Wizard!</h1>
                    <p class="welcome-text">
                        Your personal AI-powered accounting tutor. I specialize in helping Grade 11 students master 
                        accounting fundamentals from journal entries to trial balance. Ask me anything!
                    </p>
                    <div class="welcome-features">
                        <div class="feature-box">
                            <span class="feature-icon">üìñ</span>
                            <h3 class="feature-name">Journal Entries</h3>
                            <p class="feature-desc">Learn to record transactions correctly</p>
                        </div>
                        <div class="feature-box">
                            <span class="feature-icon">üìä</span>
                            <h3 class="feature-name">Ledger Posting</h3>
                            <p class="feature-desc">Master the art of ledger accounts</p>
                        </div>
                        <div class="feature-box">
                            <span class="feature-icon">‚öñÔ∏è</span>
                            <h3 class="feature-name">Trial Balance</h3>
                            <p class="feature-desc">Verify your books are balanced</p>
                        </div>
                        <div class="feature-box">
                            <span class="feature-icon">üí∞</span>
                            <h3 class="feature-name">Cash Book</h3>
                            <p class="feature-desc">Understand cash transactions</p>
                        </div>
                    </div>
                    <button class="start-btn" onclick="hideWelcome()">
                        Start Learning Now üöÄ
                    </button>
                </div>
            </div>

            <!-- Chat Input Area -->
            <div class="chat-input-area">
                <div class="suggested-questions" id="suggestedQuestions">
                    <button class="suggestion-chip" onclick="askQuestion('What is double-entry bookkeeping?')">
                        üíº Double-entry bookkeeping
                    </button>
                    <button class="suggestion-chip" onclick="askQuestion('Explain debit and credit rules')">
                        üìä Debit & Credit rules
                    </button>
                    <button class="suggestion-chip" onclick="askQuestion('How to prepare a journal entry?')">
                        üìù Journal entry
                    </button>
                    <button class="suggestion-chip" onclick="askQuestion('What is a ledger account?')">
                        üìö Ledger account
                    </button>
                    <button class="suggestion-chip" onclick="askQuestion('How to prepare trial balance?')">
                        ‚öñÔ∏è Trial balance
                    </button>
                </div>
                <div class="input-container">
                    <div class="input-wrapper">
                        <textarea 
                            id="userInput" 
                            placeholder="Ask me anything about accounting..."
                            rows="1"
                            onkeydown="handleKeyPress(event)"
                            oninput="autoResize(this)"></textarea>
                    </div>
                    <button class="send-btn" onclick="sendMessage()">üöÄ</button>
                </div>
            </div>
        </div>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <!-- AI Profile -->
            <div class="ai-profile-card">
                <div class="profile-avatar">üßô</div>
                <h3 class="profile-name">Accounts Wizard</h3>
                <p class="profile-description">
                    I'm your AI accounting tutor specializing in Grade 11 accountancy. From basic concepts to trial balance preparation!
                </p>
                <div class="profile-tags">
                    <span class="tag">üìñ Journal</span>
                    <span class="tag">üìö Ledger</span>
                    <span class="tag">‚öñÔ∏è Trial Balance</span>
                    <span class="tag">üí∞ Cash Book</span>
                </div>
            </div>

            <!-- Stats -->
            <div class="sidebar-section">
                <h3 class="section-header">üìä Your Stats</h3>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-value" id="questionsCount">0</span>
                        <span class="stat-label">Questions</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value" id="timeSpent">0m</span>
                        <span class="stat-label">Time</span>
                    </div>
                </div>
            </div>

            <!-- Quick Topics (Accounting Only) -->
            <div class="sidebar-section">
                <h3 class="section-header">üöÄ Quick Topics</h3>
                <button class="topic-btn" onclick="askQuestion('What is double-entry bookkeeping?')">
                    <span class="topic-icon">üíº</span>
                    Double-Entry System
                </button>
                <button class="topic-btn" onclick="askQuestion('Explain debit and credit rules')">
                    <span class="topic-icon">üìä</span>
                    Debit & Credit
                </button>
                <button class="topic-btn" onclick="askQuestion('How to prepare a journal entry?')">
                    <span class="topic-icon">üìù</span>
                    Journal Entry
                </button>
                <button class="topic-btn" onclick="askQuestion('What is a ledger account?')">
                    <span class="topic-icon">üìö</span>
                    Ledger Account
                </button>
                <button class="topic-btn" onclick="askQuestion('What is a cash book?')">
                    <span class="topic-icon">üí∞</span>
                    Cash Book
                </button>
                <button class="topic-btn" onclick="askQuestion('How to prepare trial balance?')">
                    <span class="topic-icon">‚öñÔ∏è</span>
                    Trial Balance
                </button>
            </div>

            <!-- Achievements -->
            <div class="sidebar-section">
                <h3 class="section-header">üèÜ Achievements</h3>
                <div class="achievement-item locked" id="achievement1">
                    <span class="achievement-icon">üéØ</span>
                    <div class="achievement-info">
                        <div class="achievement-title">First Question</div>
                        <div class="achievement-desc">Ask your first question</div>
                    </div>
                </div>
                <div class="achievement-item locked" id="achievement2">
                    <span class="achievement-icon">üî•</span>
                    <div class="achievement-info">
                        <div class="achievement-title">Curious Learner</div>
                        <div class="achievement-desc">Ask 10 questions</div>
                    </div>
                </div>
                <div class="achievement-item locked" id="achievement3">
                    <span class="achievement-icon">üíé</span>
                    <div class="achievement-info">
                        <div class="achievement-title">Accounting Master</div>
                        <div class="achievement-desc">Ask 25 questions</div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="sidebar-section">
                <h3 class="section-header">‚ö° Quick Actions</h3>
                <div class="quick-actions">
                    <button class="quick-action" onclick="clearChat()">
                        <span class="quick-action-icon">üóëÔ∏è</span>
                        <span class="quick-action-label">Clear Chat</span>
                    </button>
                    <button class="quick-action" onclick="exportChat()">
                        <span class="quick-action-icon">üì•</span>
                        <span class="quick-action-label">Export</span>
                    </button>
                    <button class="quick-action" onclick="printChat()">
                        <span class="quick-action-icon">üñ®Ô∏è</span>
                        <span class="quick-action-label">Print</span>
                    </button>
                    <button class="quick-action" onclick="showHelp()">
                        <span class="quick-action-icon">‚ùì</span>
                        <span class="quick-action-label">Help</span>
                    </button>
                </div>
            </div>
        </aside>
    </div>

    <!-- JavaScript -->
     <script>
        // ==================== CONFIGURATION ====================
        const CONFIG = {
            // üîë PASTE YOUR GEMINI API KEY HERE (Get from: https://makersuite.google.com/app/apikey)
            apiKey: 'AIzaSyBjz1pRMb-StQFX2e37BRVbQ9WpkTNC5-c',
            
            // Gemini API endpoint
            endpoint: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-pro:generateContent',
            
            // Model name
            model: 'gemini-2.5-pro'
        };

        // ==================== STATE MANAGEMENT ====================
        const AppState = {
            questionsAsked: 0,
            startTime: Date.now(),
            chatHistory: [],
            conversationHistory: [],
            achievements: {
                achievement1: false,
                achievement2: false,
                achievement3: false
            }
        };

        // ==================== SYSTEM PROMPT ====================
        const SYSTEM_PROMPT = `You are "Accounts Wizard", an expert AI tutor specializing in Grade 11 Accounting education (basics up to Trial Balance).

        üéØ YOUR ROLE:
        - Teach accounting concepts clearly and patiently
        - Provide step-by-step explanations
        - Use examples with Indian currency (‚Çπ)
        - Focus on: Journal Entries, Ledger, Cash Book, Trial Balance, Double-Entry Bookkeeping
        - Make accounting fun and easy to understand

        üìö TOPICS YOU COVER:
        - Double-Entry Bookkeeping System
        - Debit & Credit Rules (Golden Rules)
        - Journal Entries with examples
        - Ledger Accounts and Posting
        - Cash Book (Single/Double Column)
        - Subsidiary Books
        - Trial Balance Preparation
        - Accounting Concepts and Principles

        ‚úÖ YOUR TEACHING STYLE:
        - Be encouraging and supportive
        - Use emojis to make learning fun
        - Break down complex topics into simple steps
        - Provide practical examples with ‚Çπ amounts
        - Always verify student understanding
        - Keep responses concise but thorough (200-400 words)

        ‚ùå RESTRICTIONS:
        - Stay focused on Grade 11 Accounting only
        - Don't discuss topics beyond Trial Balance
        - Politely redirect non-accounting questions

        Format responses with clear structure, examples, and step-by-step explanations.`;

        // ==================== GEMINI API FUNCTION (FIXED) ====================
        async function getAIResponse(question) {
            // Check if API key is set
            if (!CONFIG.apiKey || CONFIG.apiKey === 'YOUR_GEMINI_API_KEY_HERE') {
                return `‚ùå <strong>API Key Not Set!</strong><br><br>
                        Please follow these steps:<br>
                        1. Get free API key: <a href="https://makersuite.google.com/app/apikey" target="_blank">https://makersuite.google.com/app/apikey</a><br>
                        2. Open this HTML file in a text editor<br>
                        3. Find line 3: <code>apiKey: 'YOUR_GEMINI_API_KEY_HERE'</code><br>
                        4. Replace with your actual key<br>
                        5. Save and refresh!`;
            }
            
            try {
                // Build conversation context
                let conversationText = SYSTEM_PROMPT + '\n\n';
                
                // Add recent conversation for context (last 3 exchanges)
                if (AppState.conversationHistory.length > 0) {
                    conversationText += 'Previous conversation:\n';
                    const recentHistory = AppState.conversationHistory.slice(-6); // Last 3 Q&A pairs
                    recentHistory.forEach(msg => {
                        conversationText += `${msg.role === 'user' ? 'Student' : 'Tutor'}: ${msg.content}\n`;
                    });
                    conversationText += '\n';
                }
                
                conversationText += `Student: ${question}\n\nTutor (respond in 200-400 words):`;
                
                // Gemini API call with correct format
                const url = `${CONFIG.endpoint}?key=${CONFIG.apiKey}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: conversationText
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            topK: 40,
                            topP: 0.95,
                            maxOutputTokens: 8192,
                        },
                        safetySettings: [
                            {
                                category: "HARM_CATEGORY_HARASSMENT",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_HATE_SPEECH",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                                threshold: "BLOCK_NONE"
                            },
                            {
                                category: "HARM_CATEGORY_DANGEROUS_CONTENT",
                                threshold: "BLOCK_NONE"
                            }
                        ]
                    })
                });
                
                // Check response status
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('API Error Response:', errorData);
                    
                    // Handle specific errors
                    if (response.status === 400) {
                        if (errorData.error?.message?.includes('API_KEY_INVALID')) {
                            return 'üîë <strong>Invalid API Key!</strong><br><br>Your API key is not valid. Please:<br>1. Check you copied it correctly<br>2. Make sure it\'s enabled in Google Cloud Console<br>3. Try generating a new key';
                        }
                        return `‚ùå Bad Request: ${errorData.error?.message || 'Unknown error'}`;
                    }
                    
                    if (response.status === 429) {
                        return '‚è∞ <strong>Rate Limit Exceeded!</strong><br><br>Gemini free tier limits:<br>‚Ä¢ 60 requests per minute<br>‚Ä¢ Please wait a moment and try again!';
                    }
                    
                    if (response.status === 403) {
                        return 'üö´ <strong>API Key Error!</strong><br><br>Your API key might be:<br>‚Ä¢ Restricted to certain IPs<br>‚Ä¢ Not enabled for Gemini API<br>‚Ä¢ Expired<br><br>Check your Google Cloud Console settings.';
                    }
                    
                    throw new Error(`API returned ${response.status}: ${errorData.error?.message || 'Unknown error'}`);
                }
                
                const data = await response.json();
                
                // Check if response has content
                if (!data.candidates || !data.candidates[0] || !data.candidates[0].content) {
                    console.error('Unexpected response format:', data);
                    return '‚ùå Received unexpected response from AI. Please try again.';
                }
                
                const aiResponse = data.candidates[0].content.parts[0].text;
                
                // Update conversation history
                AppState.conversationHistory.push(
                    { role: 'user', content: question },
                    { role: 'assistant', content: aiResponse }
                );
                
                // Keep only last 10 exchanges (20 messages)
                if (AppState.conversationHistory.length > 20) {
                    AppState.conversationHistory = AppState.conversationHistory.slice(-20);
                }
                
                return aiResponse;
                
            } catch (error) {
                console.error('AI API Error:', error);
                
                // Network errors
                if (error.message.includes('Failed to fetch') || error.message.includes('NetworkError')) {
                    return 'üåê <strong>Network Error!</strong><br><br>Please check:<br>‚Ä¢ Your internet connection<br>‚Ä¢ If you\'re behind a firewall<br>‚Ä¢ Try refreshing the page';
                }
                
                return `‚ùå <strong>Error:</strong> ${error.message}<br><br>Please check the browser console (F12) for more details.`;
            }
        }

        // ==================== MESSAGE FUNCTIONS ====================
        async function sendMessage() {
            const input = document.getElementById('userInput');
            const question = input.value.trim();
            
            if (!question) return;
            
            // Hide welcome screen
            hideWelcome();
            
            // Add user message
            addUserMessage(question);
            
            // Clear input
            input.value = '';
            input.style.height = 'auto';
            
            // Update stats
            AppState.questionsAsked++;
            updateStats();
            checkAchievements();
            
            // Show typing indicator
            showTypingIndicator();
            
            // Get AI response
            try {
                const response = await getAIResponse(question);
                hideTypingIndicator();
                addAIMessage(response);
                
                // Save to history
                AppState.chatHistory.push({
                    type: 'user',
                    content: question,
                    timestamp: new Date().toISOString()
                });
                AppState.chatHistory.push({
                    type: 'ai',
                    content: response,
                    timestamp: new Date().toISOString()
                });
                
                saveToLocalStorage();
                
            } catch (error) {
                hideTypingIndicator();
                addAIMessage(`‚ùå Sorry, I encountered an error: ${error.message}`);
            }
        }

        function askQuestion(question) {
            document.getElementById('userInput').value = question;
            sendMessage();
        }

        function addUserMessage(text) {
            const messagesArea = document.getElementById('messagesArea');
            const messageWrapper = document.createElement('div');
            messageWrapper.className = 'message-wrapper';
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            messageWrapper.innerHTML = `
                <div class="message user">
                    <div class="message-avatar">üë§</div>
                    <div class="message-content">
                        <div class="message-bubble">${escapeHtml(text)}</div>
                        <div class="message-time">üïê ${time}</div>
                    </div>
                </div>
            `;
            
            messagesArea.appendChild(messageWrapper);
            scrollToBottom();
        }

        function addAIMessage(text) {
            const messagesArea = document.getElementById('messagesArea');
            const messageWrapper = document.createElement('div');
            messageWrapper.className = 'message-wrapper';
            
            const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            
            // Convert markdown-style formatting to HTML
            let formattedText = text
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/`(.+?)`/g, '<code>$1</code>')
                .replace(/\n/g, '<br>');
            
            messageWrapper.innerHTML = `
                <div class="message ai">
                    <div class="message-avatar">üßô</div>
                    <div class="message-content">
                        <div class="message-bubble">${formattedText}</div>
                        <div class="message-time">üïê ${time}</div>
                    </div>
                </div>
            `;
            
            messagesArea.appendChild(messageWrapper);
            scrollToBottom();
        }

        function showTypingIndicator() {
            const messagesArea = document.getElementById('messagesArea');
            const typingWrapper = document.createElement('div');
            typingWrapper.className = 'message-wrapper';
            typingWrapper.id = 'typingIndicator';
            
            typingWrapper.innerHTML = `
                <div class="message ai">
                    <div class="message-avatar">üßô</div>
                    <div class="message-content">
                        <div class="typing-indicator">
                            <div class="typing-dots">
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                                <div class="typing-dot"></div>
                            </div>
                            <span class="typing-text">Wizard is thinking...</span>
                        </div>
                    </div>
                </div>
            `;
            
            messagesArea.appendChild(typingWrapper);
            scrollToBottom();
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }

        function hideWelcome() {
            const welcomeScreen = document.getElementById('welcomeScreen');
            if (welcomeScreen) {
                welcomeScreen.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => welcomeScreen.remove(), 300);
            }
        }

        function scrollToBottom() {
            const messagesArea = document.getElementById('messagesArea');
            messagesArea.scrollTop = messagesArea.scrollHeight;
        }

        // ==================== STATS & ACHIEVEMENTS ====================
        function updateStats() {
            document.getElementById('questionsCount').textContent = AppState.questionsAsked;
            const timeSpent = Math.floor((Date.now() - AppState.startTime) / 60000);
            document.getElementById('timeSpent').textContent = timeSpent + 'm';
        }

        function checkAchievements() {
            if (AppState.questionsAsked >= 1 && !AppState.achievements.achievement1) {
                unlockAchievement('achievement1', 'First Question');
            }
            if (AppState.questionsAsked >= 10 && !AppState.achievements.achievement2) {
                unlockAchievement('achievement2', 'Curious Learner');
            }
            if (AppState.questionsAsked >= 25 && !AppState.achievements.achievement3) {
                unlockAchievement('achievement3', 'Accounting Master');
            }
        }

        function unlockAchievement(id, name) {
            const achievement = document.getElementById(id);
            if (achievement && !AppState.achievements[id]) {
                achievement.classList.remove('locked');
                achievement.classList.add('unlocked');
                AppState.achievements[id] = true;
                showNotification(`üéâ Achievement Unlocked: ${name}!`);
                saveToLocalStorage();
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 85px;
                right: 25px;
                background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
                color: var(--bg-primary);
                padding: 15px 25px;
                border-radius: 12px;
                font-weight: 700;
                font-size: 14px;
                box-shadow: 0 10px 30px rgba(0, 255, 136, 0.4);
                z-index: 10000;
                animation: slideInRight 0.4s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.4s ease';
                setTimeout(() => notification.remove(), 400);
            }, 3000);
        }

        // ==================== UTILITY FUNCTIONS ====================
        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 150) + 'px';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ==================== CHAT ACTIONS ====================
        function clearChat() {
            if (confirm('Clear all messages? This cannot be undone.')) {
                const messagesArea = document.getElementById('messagesArea');
                messagesArea.innerHTML = `
                    <div class="welcome-screen">
                        <div class="welcome-icon">üßô‚Äç‚ôÇÔ∏è</div>
                        <h1 class="welcome-title">Chat Cleared!</h1>
                        <p class="welcome-text">Ready to start fresh? Ask me anything about accounting!</p>
                        <button class="start-btn" onclick="hideWelcome()">Continue Learning üöÄ</button>
                    </div>
                `;
                AppState.chatHistory = [];
                AppState.conversationHistory = [];
                saveToLocalStorage();
                showNotification('üí¨ Chat cleared successfully!');
            }
        }

        function exportChat() {
            if (AppState.chatHistory.length === 0) {
                alert('üî≠ No messages to export yet! Start asking questions first.');
                return;
            }
            
            let exportText = `ACCOUNTS WIZARD AI - CHAT EXPORT\n${'='.repeat(50)}\n`;
            exportText += `Date: ${new Date().toLocaleString()}\n`;
            exportText += `Total Questions: ${AppState.questionsAsked}\n${'='.repeat(50)}\n\n`;
            
            AppState.chatHistory.forEach(msg => {
                const time = new Date(msg.timestamp).toLocaleTimeString();
                const sender = msg.type === 'user' ? 'YOU' : 'ACCOUNTS WIZARD';
                const content = msg.content.replace(/<[^>]*>/g, '').replace(/&nbsp;/g, ' ');
                exportText += `[${time}] ${sender}:\n${content}\n\n${'-'.repeat(50)}\n\n`;
            });
            
            const blob = new Blob([exportText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `accounts-wizard-chat-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            showNotification('üì• Chat exported successfully!');
        }

        function downloadChat() { exportChat(); }

        function shareChat() {
            const shareText = `I've learned accounting with Accounts Wizard AI! ${AppState.questionsAsked} questions asked! üßôüìö`;
            if (navigator.share) {
                navigator.share({
                    title: 'Accounts Wizard AI',
                    text: shareText,
                    url: window.location.href
                }).then(() => showNotification('üì§ Shared successfully!'))
                .catch(() => copyToClipboard(shareText));
            } else {
                copyToClipboard(shareText);
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text + '\n' + window.location.href)
                .then(() => showNotification('üîó Link copied to clipboard!'));
        }

        function printChat() { window.print(); }

        function showHelp() {
            const helpMessage = `
                <div class="message-wrapper">
                    <div class="message ai">
                        <div class="message-avatar">üßô</div>
                        <div class="message-content">
                            <div class="message-bubble">
                                <strong>üìö Accounts Wizard AI - Powered by Google Gemini!</strong><br><br>
                                <strong>üéØ What I Can Help With:</strong><br>
                                ‚úÖ Grade 11 Accounting (up to Trial Balance)<br>
                                ‚úÖ Journal Entries & Ledger<br>
                                ‚úÖ Cash Book & Trial Balance<br>
                                ‚úÖ Debit & Credit Rules<br><br>
                                <strong>üí° Tips:</strong><br>
                                ‚Ä¢ Ask follow-up questions<br>
                                ‚Ä¢ Request examples with ‚Çπ amounts<br>
                                ‚Ä¢ The AI remembers our conversation!<br><br>
                                <strong>üìñ Try asking:</strong><br>
                                ‚Ä¢ "Explain double-entry bookkeeping"<br>
                                ‚Ä¢ "Show me a journal entry example"<br>
                                ‚Ä¢ "How to balance a ledger?"<br><br>
                                Let's learn accounting together! üöÄ
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            const messagesArea = document.getElementById('messagesArea');
            const welcomeScreen = document.getElementById('welcomeScreen');
            if (welcomeScreen) welcomeScreen.remove();
            messagesArea.insertAdjacentHTML('beforeend', helpMessage);
            scrollToBottom();
        }

        // ==================== LOCAL STORAGE ====================
        function saveToLocalStorage() {
            try {
                localStorage.setItem('accountsWizard_state', JSON.stringify({
                    questionsAsked: AppState.questionsAsked,
                    achievements: AppState.achievements,
                    lastVisit: new Date().toISOString()
                }));
            } catch (e) {
                console.warn('Could not save:', e);
            }
        }

        function loadFromLocalStorage() {
            try {
                const saved = localStorage.getItem('accountsWizard_state');
                if (saved) {
                    const data = JSON.parse(saved);
                    AppState.questionsAsked = data.questionsAsked || 0;
                    AppState.achievements = data.achievements || AppState.achievements;
                    updateStats();
                    Object.keys(data.achievements || {}).forEach(key => {
                        if (data.achievements[key]) {
                            const elem = document.getElementById(key);
                            if (elem) {
                                elem.classList.remove('locked');
                                elem.classList.add('unlocked');
                            }
                        }
                    });
                }
            } catch (e) {
                console.warn('Could not load:', e);
            }
        }

        setInterval(saveToLocalStorage, 30000);
        window.addEventListener('beforeunload', saveToLocalStorage);

        // ==================== ANIMATIONS ====================
        const styleSheet = document.createElement('style');
        styleSheet.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(styleSheet);

        // ==================== INITIALIZATION ====================
        function initializeApp() {
            console.log('%cüßô ACCOUNTS WIZARD AI - GEMINI POWERED', 'font-size: 20px; color: #00ff88; font-weight: bold;');
            console.log('%c‚ú® Free Forever with Google Gemini!', 'font-size: 14px; color: #00d4ff;');
            loadFromLocalStorage();
            setInterval(updateStats, 60000);
            document.getElementById('userInput').focus();
            
            // Welcome message
            setTimeout(() => {
                if (CONFIG.apiKey === 'YOUR_GEMINI_API_KEY_HERE') {
                    showNotification('‚ö†Ô∏è Please set your Gemini API key in the code!');
                } else {
                    showNotification('üéâ AI Ready! Start asking questions!');
                }
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', initializeApp);

        document.addEventListener('DOMContentLoaded', function() {
            const userInput = document.getElementById('userInput');
            userInput.addEventListener('input', function() {
                autoResize(this);
            });
        });

        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) updateStats();
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                clearChat();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                e.preventDefault();
                exportChat();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'h') {
                e.preventDefault();
                showHelp();
            }
            if (e.key === 'Escape') {
                document.getElementById('userInput').value = '';
                document.getElementById('userInput').style.height = 'auto';
            }
        });

        console.log('%c‚úÖ Gemini AI System Ready!', 'color: #00ff88; font-weight: bold; font-size: 16px');
        console.log('%cüîë API Key Status: ' + (CONFIG.apiKey === 'YOUR_GEMINI_API_KEY_HERE' ? 'NOT SET ‚ùå' : 'SET ‚úÖ'), 'color: #ffd700');
     </script>
</body>
</html>