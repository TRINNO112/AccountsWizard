<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Chapter 7 – Double Entry System | AccountsWizard</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <link rel="stylesheet" href="main.css">
  <style>
    :root {
      --bg: #0b1020;
      --bg-2: #0f1733;
      --card: #111633;
      --muted: #b8c2ff;
      --brand: #7c4dff;
      --brand-2: #00e5ff;
      --accent: #ff7ac6;
      --text: #e9eefc;
      --radius: 16px;
      --shadow: 0 18px 40px rgba(2,6,23,.55);
      --speed: 300ms;
    }
    
    * { box-sizing: border-box; }
    
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, Roboto, Arial;
      color: var(--text);
      background: linear-gradient(180deg, var(--bg), var(--bg-2));
      min-height: 100vh;
      padding: 20px;
      overflow-x: hidden;
    }
    
    header { text-align: center; padding: 30px 20px; }
    
    .lesson-title {
      font-size: 2.2rem; font-weight: 900;
      background: linear-gradient(90deg,#fff,var(--accent));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    
    .breadcrumb { color: var(--muted); font-size: .95rem; }
    .breadcrumb a { color: inherit; text-decoration: none; }
    .breadcrumb a:hover { color: var(--text); }
    
    .nav-header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px 24px; background: var(--card); border-radius: var(--radius);
      margin-bottom: 32px; box-shadow: var(--shadow);
    }
    
    .nav-header a {
      color: var(--muted); text-decoration: none; display: flex; align-items: center;
      gap: 8px; padding: 8px 16px; border-radius: 8px; transition: all var(--speed);
    }
    
    .nav-header a:hover { color: var(--text); background: rgba(255,255,255,.1); }
    
    section {
      background: var(--card); border-radius: var(--radius);
      padding: 32px; margin-bottom: 32px; box-shadow: var(--shadow);
      overflow: visible;
    }
    
    section h2 {
      margin-top: 0; font-size: 1.5rem;
      background: linear-gradient(90deg,#fff,var(--brand-2));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    
    section p { line-height: 1.6; color: var(--muted); }

    /* Animation System */
    .animate-card {
      opacity: 1;
      transform: translateY(0) scale(1);
      transition: all 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
    }

    .animate-card.animate-pending {
      opacity: 0;
      transform: translateY(30px) scale(0.95);
    }

    .animate-card.animate-pending.visible {
      opacity: 1;
      transform: translateY(0) scale(1);
    }

    .animate-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 25px 50px rgba(2,6,23,.8) !important;
    }

    .process-card {
      opacity: 0;
      transform: translateX(-40px) rotateY(15deg);
      transition: all 0.7s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .process-card.visible {
      opacity: 1;
      transform: translateX(0) rotateY(0deg);
    }

    .equation-card {
      opacity: 0;
      transform: translateY(50px) rotateX(20deg);
      transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .equation-card.visible {
      opacity: 1;
      transform: translateY(0) rotateX(0deg);
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }

    @keyframes pulse-border {
      0% { box-shadow: 0 0 0 0 rgba(124, 77, 255, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(124, 77, 255, 0); }
      100% { box-shadow: 0 0 0 0 rgba(124, 77, 255, 0); }
    }

    .animate-card:hover {
      animation: pulse-border 1.5s infinite;
    }

    /* Definition Box */
    .definition-box {
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      padding: 25px;
      border-radius: 15px;
      margin: 20px 0;
      border-left: 5px solid #ff6b6b;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      color: #2d3748;
    }

    /* Principles Grid */
    .principles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .principle-card {
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      padding: 20px;
      border-radius: 15px;
      transition: all 0.3s ease;
      color: #2d3748;
    }

    .principle-card:hover {
      transform: scale(1.05);
      box-shadow: 0 15px 30px rgba(0,0,0,0.2);
    }

    /* Account Classification */
    .accounts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
      margin: 30px 0;
    }

    .account-type {
      padding: 24px;
      border-radius: 16px;
      text-align: center;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .account-type::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.8s ease;
    }

    .account-type:hover::before {
      left: 100%;
    }

    .personal-account {
      background: linear-gradient(135deg, var(--brand), rgba(124, 77, 255, 0.8));
      border: 2px solid rgba(255,255,255,0.2);
    }

    .real-account {
      background: linear-gradient(135deg, var(--brand-2), rgba(0, 229, 255, 0.8));
      border: 2px solid rgba(255,255,255,0.2);
    }

    .nominal-account {
      background: linear-gradient(135deg, var(--accent), rgba(255, 122, 198, 0.8));
      border: 2px solid rgba(255,255,255,0.2);
    }

    /* Rules Table */
    .rules-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: rgba(255,255,255,0.02);
    }

    .rules-table th,
    .rules-table td {
      padding: 15px;
      text-align: left;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .rules-table th {
      background: rgba(255,255,255,0.05);
      font-weight: 700;
      color: var(--brand-2);
    }

    .rules-table tr:nth-child(even) {
      background: rgba(255,255,255,0.02);
    }

    .rules-table tr:hover {
      background: rgba(255,255,255,0.05);
      transform: translateX(5px);
    }

    /* Example Card */
    .example-card {
      background: linear-gradient(135deg, rgba(124,77,255,0.1), rgba(0,229,255,0.05));
      border-radius: 16px;
      padding: 25px;
      margin: 20px 0;
      border-left: 5px solid var(--brand);
      position: relative;
    }

    .example-card::before {
      content: '💡';
      position: absolute;
      top: -10px;
      right: 20px;
      font-size: 2rem;
      background: var(--card);
      padding: 10px;
      border-radius: 50%;
      border: 2px solid var(--brand);
    }

    /* Classification Exercise */
    .classification-exercise {
      background: rgba(255,255,255,0.02);
      border-radius: 16px;
      padding: 25px;
      margin: 25px 0;
      border: 2px solid rgba(255,255,255,0.1);
    }

    .account-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 12px 15px;
      margin: 8px 0;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .account-item:hover {
      background: rgba(255,255,255,0.06);
      transform: translateX(5px);
    }

    .account-item select {
      background: var(--card);
      color: var(--text);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 6px;
      padding: 8px 12px;
      min-width: 150px;
    }

    /* Stages Section */
    .stages-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin: 25px 0;
    }

    .stage-card {
      background: linear-gradient(145deg, var(--card), rgba(255,255,255,0.05));
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      transition: all 0.3s ease;
      border: 2px solid transparent;
      position: relative;
      overflow: hidden;
    }

    .stage-card:hover {
      border-color: var(--brand-2);
      transform: translateY(-5px);
    }

    .stage-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--brand), var(--brand-2), var(--accent));
    }

    .stage-number {
      background: var(--brand);
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-weight: bold;
      font-size: 1.2rem;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .accounts-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .principles-grid {
        grid-template-columns: 1fr;
      }
      
      .stages-grid {
        grid-template-columns: 1fr;
      }
      
      .rules-table {
        font-size: 0.85rem;
      }
      
      .rules-table th,
      .rules-table td {
        padding: 10px 8px;
      }
    }

    /* Animation keyframes */
    @keyframes shakeX {
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-8px)}
      40%{transform:translateX(8px)}
      60%{transform:translateX(-6px)}
      80%{transform:translateX(6px)}
    }
    .aw-shake{animation:shakeX 0.4s ease}
    .aw-pop{animation:popIn 0.35s ease both}
    @keyframes popIn {
      0%{opacity:0;transform:translateY(10px) scale(.96)}
      60%{opacity:1;transform:translateY(-4px) scale(1.02)}
      100%{opacity:1;transform:translateY(0) scale(1)}
    }

    .hidden-score {
      display: none;
      margin-top: 20px;
      padding: 20px;
      background: linear-gradient(135deg, rgba(76,175,80,0.1), rgba(129,199,132,0.1));
      border-radius: 12px;
      border-left: 5px solid #4caf50;
    }
  </style>
</head>
<body>
  <div class="nav-header">
    <a href="../index.html"><i class="fa-solid fa-house"></i><span>Home</span></a>
    <a href="../lessons.html"><i class="fa-solid fa-book"></i><span>All Lessons</span></a>
  </div>

  <header>
    <h1 class="lesson-title">Double Entry System</h1>
    <div class="breadcrumb">
      <a href="../index.html">Home</a> / 
      <a href="../lessons.html">Lessons</a> / 
      Double Entry System
    </div>
  </header>

  <main>

    <!-- Introduction Section -->
    <section class="animate-card">
      <h2>What is Double Entry System?</h2>
      
      <div class="definition-box animate-card">
        <h3 style="margin:0 0 15px 0; color:#2d3748; display: flex; align-items: center; gap: 10px;">
          <i class="fas fa-balance-scale" style="color:#ff6b6b;"></i>
          Definition
        </h3>
        <p style="color:#2d3748; margin:0; font-size:1.1rem; line-height:1.6;">
          The <strong>Double Entry System</strong> is a method of bookkeeping where every 
          business transaction affects at least two accounts, and the total amount debited 
          equals the total amount credited. This system ensures that the accounting equation 
          <strong>(Assets = Liabilities + Capital)</strong> always remains balanced.
        </p>
      </div>

      <p style="font-size:1.1rem; line-height:1.8; color: var(--muted);">
        Developed by Italian mathematician <strong>Luca Pacioli</strong> in 1494, this system 
        forms the foundation of modern accounting. It provides a complete record of all financial 
        transactions and serves as a built-in error-checking mechanism for businesses worldwide.
      </p>

      <div style="
        margin-top:20px; 
        padding:20px; 
        border-radius:12px; 
        background:rgba(255,255,255,0.04);
        box-shadow: var(--shadow); 
        text-align:center;"
        class="animate-card">
        <i class="fas fa-lightbulb" style="font-size:2rem; color:var(--brand-2); margin-bottom:10px;"></i>
        <h3 style="margin:10px 0; color: var(--text);">Why Double Entry System?</h3>
        <p style="color:var(--muted); font-size:0.95rem; line-height:1.6;">
          This system provides accuracy, completeness, and helps detect errors automatically. 
          It's mandatory for businesses and forms the basis of financial statements.
        </p>
      </div>
    </section>

    <!-- Principles and Characteristics -->
    <section class="animate-card">
      <h2>Principles and Characteristics</h2>
      
      <div class="principles-grid">
        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-equals" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Dual Aspect</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            Every transaction has two aspects - a debit and a credit. The total of all 
            debits must equal the total of all credits.
          </p>
        </div>

        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-check-double" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Complete Recording</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            All business transactions are recorded completely with proper documentation 
            and supporting evidence.
          </p>
        </div>

        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-shield-alt" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Error Detection</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            Built-in mechanism to detect mathematical errors through trial balance. 
            If debits don't equal credits, there's an error.
          </p>
        </div>

        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-file-alt" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Financial Statements</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            Provides basis for preparing Income Statement, Balance Sheet, and 
            Cash Flow Statement accurately.
          </p>
        </div>

        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-search" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Transparency</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            Creates clear audit trail and provides transparency for stakeholders, 
            investors, and regulatory authorities.
          </p>
        </div>

        <div class="principle-card animate-card process-card">
          <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 15px;">
            <i class="fas fa-clock" style="font-size:1.8rem; color:#4a5568;"></i>
            <h3 style="margin: 0; color: #2d3748; font-size: 1.2rem;">Systematic</h3>
          </div>
          <p style="color: #4a5568; margin: 0; line-height: 1.6;">
            Follows systematic approach with proper sequence: Journal → Ledger → 
            Trial Balance → Financial Statements.
          </p>
        </div>
      </div>
    </section>

    <!-- Classification of Accounts -->
    <section class="animate-card">
      <h2>Classification of Accounts</h2>
      <p style="font-size:1.05rem; color:var(--muted); line-height:1.7;">
        In double entry system, all accounts are classified into three main categories. 
        Each category has specific rules for debiting and crediting.
      </p>

      <div class="accounts-grid">
        
        <!-- Personal Accounts -->
        <div class="account-type personal-account animate-card equation-card">
          <div style="margin-bottom: 20px;">
            <i class="fas fa-user-tie" style="font-size: 3rem; color: white; margin-bottom: 15px;"></i>
            <h3 style="margin: 0; color: white; font-size: 1.4rem;">PERSONAL ACCOUNTS</h3>
            <p style="color: rgba(255,255,255,0.9); margin: 10px 0; font-size: 0.95rem;">
              Accounts related to persons, firms, or organizations
            </p>
          </div>
          
          <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <h4 style="color: white; margin: 0 0 10px 0;">Rule:</h4>
            <p style="color: white; margin: 0; font-weight: bold;">
              Debit the Receiver<br>
              Credit the Giver
            </p>
          </div>

          <div style="text-align: left; color: rgba(255,255,255,0.9); font-size: 0.9rem;">
            <strong>Examples:</strong>
            <ul style="margin: 8px 0; padding-left: 20px;">
              <li>Ram's Account</li>
              <li>ABC Company Ltd.</li>
              <li>Bank Account</li>
              <li>Capital Account</li>
              <li>Drawings Account</li>
            </ul>
          </div>
        </div>

        <!-- Real Accounts -->
        <div class="account-type real-account animate-card equation-card">
          <div style="margin-bottom: 20px;">
            <i class="fas fa-building" style="font-size: 3rem; color: white; margin-bottom: 15px;"></i>
            <h3 style="margin: 0; color: white; font-size: 1.4rem;">REAL ACCOUNTS</h3>
            <p style="color: rgba(255,255,255,0.9); margin: 10px 0; font-size: 0.95rem;">
              Accounts related to assets and properties
            </p>
          </div>
          
          <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <h4 style="color: white; margin: 0 0 10px 0;">Rule:</h4>
            <p style="color: white; margin: 0; font-weight: bold;">
              Debit what comes in<br>
              Credit what goes out
            </p>
          </div>

          <div style="text-align: left; color: rgba(255,255,255,0.9); font-size: 0.9rem;">
            <strong>Examples:</strong>
            <ul style="margin: 8px 0; padding-left: 20px;">
              <li>Cash Account</li>
              <li>Furniture Account</li>
              <li>Machinery Account</li>
              <li>Building Account</li>
              <li>Stock Account</li>
            </ul>
          </div>
        </div>

        <!-- Nominal Accounts -->
        <div class="account-type nominal-account animate-card equation-card">
          <div style="margin-bottom: 20px;">
            <i class="fas fa-chart-line" style="font-size: 3rem; color: white; margin-bottom: 15px;"></i>
            <h3 style="margin: 0; color: white; font-size: 1.4rem;">NOMINAL ACCOUNTS</h3>
            <p style="color: rgba(255,255,255,0.9); margin: 10px 0; font-size: 0.95rem;">
              Accounts related to expenses, income, and losses
            </p>
          </div>
          
          <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
            <h4 style="color: white; margin: 0 0 10px 0;">Rule:</h4>
            <p style="color: white; margin: 0; font-weight: bold;">
              Debit all Expenses & Losses<br>
              Credit all Incomes & Gains
            </p>
          </div>

          <div style="text-align: left; color: rgba(255,255,255,0.9); font-size: 0.9rem;">
            <strong>Examples:</strong>
            <ul style="margin: 8px 0; padding-left: 20px;">
              <li>Rent Account</li>
              <li>Salary Account</li>
              <li>Sales Account</li>
              <li>Interest Received</li>
              <li>Commission Account</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Detailed Rules Table -->
      <div style="margin-top: 40px;" class="animate-card">
        <h3 style="color: var(--text); margin-bottom: 20px;">Golden Rules Summary</h3>
        <table class="rules-table">
          <thead>
            <tr>
              <th>Account Type</th>
              <th>Debit</th>
              <th>Credit</th>
              <th>Example Transaction</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-left: 4px solid var(--brand);">
              <td><strong>Personal</strong></td>
              <td>Receiver</td>
              <td>Giver</td>
              <td>Cash received from Ram - Debit Cash, Credit Ram</td>
            </tr>
            <tr style="border-left: 4px solid var(--brand-2);">
              <td><strong>Real</strong></td>
              <td>What comes in</td>
              <td>What goes out</td>
              <td>Furniture purchased - Debit Furniture, Credit Cash</td>
            </tr>
            <tr style="border-left: 4px solid var(--accent);">
              <td><strong>Nominal</strong></td>
              <td>Expenses & Losses</td>
              <td>Income & Gains</td>
              <td>Rent paid - Debit Rent, Credit Cash</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Account Classification Examples -->
    <section class="animate-card">
      <h2>Account Classification Examples</h2>
      <p style="color: var(--muted); line-height: 1.6; margin-bottom: 25px;">
        Let's classify various accounts into Personal, Real, and Nominal categories with detailed examples.
      </p>

      <div class="example-card animate-card">
        <h4 style="color: var(--brand); margin: 0 0 20px 0;">Detailed Account Classification</h4>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px;">
          
          <!-- Personal Accounts Detail -->
          <div style="background: rgba(124, 77, 255, 0.1); padding: 20px; border-radius: 12px; border-left: 4px solid var(--brand);">
            <h5 style="color: var(--brand); margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px;">
              <i class="fas fa-users"></i>
              Personal Accounts
            </h5>
            <div style="color: var(--muted); font-size: 0.9rem; line-height: 1.6;">
              <p><strong>Debtors:</strong> Ram, Shyam, ABC Ltd.</p>
              <p><strong>Creditors:</strong> Suppliers, XYZ Co.</p>
              <p><strong>Capital:</strong> Owner's Capital A/c</p>
              <p><strong>Bank:</strong> State Bank of India</p>
              <p><strong>Drawings:</strong> Personal withdrawals</p>
            </div>
          </div>

          <!-- Real Accounts Detail -->
          <div style="background: rgba(0, 229, 255, 0.1); padding: 20px; border-radius: 12px; border-left: 4px solid var(--brand-2);">
            <h5 style="color: var(--brand-2); margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px;">
              <i class="fas fa-warehouse"></i>
              Real Accounts
            </h5>
            <div style="color: var(--muted); font-size: 0.9rem; line-height: 1.6;">
              <p><strong>Current Assets:</strong> Cash, Stock, Debtors</p>
              <p><strong>Fixed Assets:</strong> Building, Machinery</p>
              <p><strong>Furniture:</strong> Office furniture</p>
              <p><strong>Vehicles:</strong> Company vehicles</p>
              <p><strong>Investments:</strong> Shares, Bonds</p>
            </div>
          </div>

          <!-- Nominal Accounts Detail -->
          <div style="background: rgba(255, 122, 198, 0.1); padding: 20px; border-radius: 12px; border-left: 4px solid var(--accent);">
            <h5 style="color: var(--accent); margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px;">
              <i class="fas fa-chart-pie"></i>
              Nominal Accounts
            </h5>
            <div style="color: var(--muted); font-size: 0.9rem; line-height: 1.6;">
              <p><strong>Expenses:</strong> Rent, Salary, Electricity</p>
              <p><strong>Income:</strong> Sales, Commission</p>
              <p><strong>Losses:</strong> Loss on sale of assets</p>
              <p><strong>Gains:</strong> Profit on investments</p>
              <p><strong>Indirect:</strong> Advertisement, Insurance</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Interactive Classification Exercise -->
      <div class="classification-exercise animate-card">
        <h4 style="color: var(--text); margin: 0 0 20px 0; text-align: center;">
          <i class="fas fa-gamepad" style="color: var(--brand-2); margin-right: 10px;"></i>
          Classification Exercise - Classify These Accounts
        </h4>
        
        <div id="classification-container">
          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">1. Rent Account</span>
            <select name="account1" data-correct="nominal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>
          
          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">2. Ramesh (Debtor)</span>
            <select name="account2" data-correct="personal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>
          
          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">3. Machinery Account</span>
            <select name="account3" data-correct="real">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>
          
          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">4. Sales Account</span>
            <select name="account4" data-correct="nominal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>

          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">5. Bank Account</span>
            <select name="account5" data-correct="personal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>

          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">6. Salary Account</span>
            <select name="account6" data-correct="nominal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>

          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">7. Building Account</span>
            <select name="account7" data-correct="real">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>

          <div class="account-item">
            <span style="flex: 1; color: var(--text); font-weight: 500;">8. Capital Account</span>
            <select name="account8" data-correct="personal">
              <option value="">Select Type</option>
              <option value="personal">Personal</option>
              <option value="real">Real</option>
              <option value="nominal">Nominal</option>
            </select>
          </div>
        </div>

        <div style="text-align: center; margin-top: 20px;">
          <button id="check-classification" style="
            background: var(--brand);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.3s ease;
          " onmouseover="this.style.background='var(--brand-2)'" onmouseout="this.style.background='var(--brand)'">Check Answers</button>
        </div>

        <div id="classification-result" class="hidden-score"></div>
      </div>
    </section>

    <!-- Practical Examples with Infographics -->
    <section class="animate-card">
      <h2>Practical Examples with Journal Entries</h2>
      
      <div class="example-card animate-card">
        <h4 style="color: var(--brand); margin: 0 0 20px 0;">Example 1: Cash Purchase of Furniture</h4>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
          <div>
            <h5 style="color: var(--text); margin-bottom: 15px;">Transaction Analysis</h5>
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
              <p style="color: var(--muted); margin: 0; line-height: 1.6;">
                <strong>Transaction:</strong> Purchased furniture for ₹10,000 by cash
              </p>
            </div>
            
            <div style="background: rgba(0, 229, 255, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid var(--brand-2);">
              <h6 style="color: var(--brand-2); margin: 0 0 10px 0;">Accounts Involved:</h6>
              <ul style="color: var(--muted); margin: 0; line-height: 1.6;">
                <li><strong>Furniture A/c</strong> - Real Account</li>
                <li><strong>Cash A/c</strong> - Real Account</li>
              </ul>
            </div>
          </div>

          <div>
            <h5 style="color: var(--text); margin-bottom: 15px;">Journal Entry</h5>
            <div style="background: rgba(124, 77, 255, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid var(--brand);">
              <table style="width: 100%; color: var(--text); font-size: 0.9rem;">
                <tr>
                  <td style="padding: 5px;">Furniture A/c</td>
                  <td style="padding: 5px; text-align: right;">Dr.</td>
                  <td style="padding: 5px; text-align: right;">10,000</td>
                </tr>
                <tr>
                  <td style="padding: 5px; padding-left: 20px;">To Cash A/c</td>
                  <td style="padding: 5px; text-align: right;">Cr.</td>
                  <td style="padding: 5px; text-align: right;">10,000</td>
                </tr>
                <tr>
                  <td colspan="3" style="padding: 10px 5px 5px 5px; font-size: 0.8rem; color: var(--muted); font-style: italic;">
                    (Being furniture purchased for cash)
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>

        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-top: 20px;">
          <h6 style="color: var(--accent); margin: 0 0 10px 0;">Rule Applied:</h6>
          <p style="color: var(--muted); margin: 0; line-height: 1.6;">
            <strong>Real Account Rule:</strong> Debit what comes in (Furniture), Credit what goes out (Cash)
          </p>
        </div>
      </div>

      <div class="example-card animate-card">
        <h4 style="color: var(--brand-2); margin: 0 0 20px 0;">Example 2: Sales on Credit</h4>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
          <div>
            <h5 style="color: var(--text); margin-bottom: 15px;">Transaction Analysis</h5>
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
              <p style="color: var(--muted); margin: 0; line-height: 1.6;">
                <strong>Transaction:</strong> Goods sold to Ram for ₹15,000 on credit
              </p>
            </div>
            
            <div style="background: rgba(255, 122, 198, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid var(--accent);">
              <h6 style="color: var(--accent); margin: 0 0 10px 0;">Accounts Involved:</h6>
              <ul style="color: var(--muted); margin: 0; line-height: 1.6;">
                <li><strong>Ram A/c</strong> - Personal Account</li>
                <li><strong>Sales A/c</strong> - Nominal Account</li>
              </ul>
            </div>
          </div>

          <div>
            <h5 style="color: var(--text); margin-bottom: 15px;">Journal Entry</h5>
            <div style="background: rgba(0, 229, 255, 0.1); padding: 15px; border-radius: 8px; border-left: 4px solid var(--brand-2);">
              <table style="width: 100%; color: var(--text); font-size: 0.9rem;">
                <tr>
                  <td style="padding: 5px;">Ram A/c</td>
                  <td style="padding: 5px; text-align: right;">Dr.</td>
                  <td style="padding: 5px; text-align: right;">15,000</td>
                </tr>
                <tr>
                  <td style="padding: 5px; padding-left: 20px;">To Sales A/c</td>
                  <td style="padding: 5px; text-align: right;">Cr.</td>
                  <td style="padding: 5px; text-align: right;">15,000</td>
                </tr>
                <tr>
                  <td colspan="3" style="padding: 10px 5px 5px 5px; font-size: 0.8rem; color: var(--muted); font-style: italic;">
                    (Being goods sold to Ram on credit)
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>

        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-top: 20px;">
          <h6 style="color: var(--accent); margin: 0 0 10px 0;">Rules Applied:</h6>
          <div style="color: var(--muted); line-height: 1.6;">
            <p style="margin: 5px 0;"><strong>Personal Account Rule:</strong> Debit the Receiver (Ram)</p>
            <p style="margin: 5px 0;"><strong>Nominal Account Rule:</strong> Credit all Income (Sales)</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Stages and Parts of Double Entry System -->
    <section class="animate-card">
      <h2>Stages and Parts of Double Entry System</h2>
      <p style="color: var(--muted); line-height: 1.6; margin-bottom: 25px;">
        The double entry system follows a systematic process with three main stages: Recording, Classification, and Summarizing.
      </p>

      <div class="stages-grid">
        
        <!-- Stage 1: Recording -->
        <div class="stage-card animate-card process-card">
          <div class="stage-number">1</div>
          <h4 style="color: var(--text); margin: 0 0 15px 0;">RECORDING</h4>
          <div style="margin-bottom: 15px;">
            <i class="fas fa-pen" style="font-size: 2.5rem; color: var(--brand); margin-bottom: 15px;"></i>
          </div>
          <p style="color: var(--muted); margin: 0; line-height: 1.6;">
            All business transactions are first recorded in the <strong>Journal</strong> (Book of Original Entry) 
            in chronological order with proper narration and supporting documents.
          </p>
          <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
            <h6 style="color: var(--brand); margin: 0 0 8px 0;">Key Features:</h6>
            <ul style="color: var(--muted); font-size: 0.9rem; margin: 0; text-align: left;">
              <li>Date-wise recording</li>
              <li>Journal entries with Dr/Cr</li>
              <li>Proper narration</li>
              <li>Folio numbers</li>
            </ul>
          </div>
        </div>

        <!-- Stage 2: Classification -->
        <div class="stage-card animate-card process-card">
          <div class="stage-number">2</div>
          <h4 style="color: var(--text); margin: 0 0 15px 0;">CLASSIFICATION</h4>
          <div style="margin-bottom: 15px;">
            <i class="fas fa-layer-group" style="font-size: 2.5rem; color: var(--brand-2); margin-bottom: 15px;"></i>
          </div>
          <p style="color: var(--muted); margin: 0; line-height: 1.6;">
            Journal entries are then posted to respective accounts in the <strong>Ledger</strong> 
            to classify similar transactions under proper account heads.
          </p>
          <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
            <h6 style="color: var(--brand-2); margin: 0 0 8px 0;">Key Features:</h6>
            <ul style="color: var(--muted); font-size: 0.9rem; margin: 0; text-align: left;">
              <li>Account-wise grouping</li>
              <li>Debit and Credit sides</li>
              <li>Balance calculation</li>
              <li>Cross referencing</li>
            </ul>
          </div>
        </div>

        <!-- Stage 3: Summarizing -->
        <div class="stage-card animate-card process-card">
          <div class="stage-number">3</div>
          <h4 style="color: var(--text); margin: 0 0 15px 0;">SUMMARIZING</h4>
          <div style="margin-bottom: 15px;">
            <i class="fas fa-chart-bar" style="font-size: 2.5rem; color: var(--accent); margin-bottom: 15px;"></i>
          </div>
          <p style="color: var(--muted); margin: 0; line-height: 1.6;">
            Ledger balances are summarized in <strong>Trial Balance</strong> and then 
            financial statements are prepared to show the financial position and performance.
          </p>
          <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1);">
            <h6 style="color: var(--accent); margin: 0 0 8px 0;">Key Features:</h6>
            <ul style="color: var(--muted); font-size: 0.9rem; margin: 0; text-align: left;">
              <li>Trial Balance</li>
              <li>Trading A/c</li>
              <li>P&L Account</li>
              <li>Balance Sheet</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- Process Flow Diagram -->
      <div class="example-card animate-card" style="margin-top: 30px;">
        <h4 style="color: var(--brand); margin: 0 0 20px 0; text-align: center;">
          <i class="fas fa-sitemap" style="margin-right: 10px;"></i>
          Complete Process Flow
        </h4>
        
        <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap; gap: 20px; margin-top: 20px;">
          
          <div style="background: rgba(124, 77, 255, 0.2); padding: 15px 20px; border-radius: 10px; text-align: center; min-width: 150px;">
            <i class="fas fa-file-alt" style="font-size: 2rem; color: var(--brand); margin-bottom: 8px;"></i>
            <h6 style="color: var(--text); margin: 0;">Source Documents</h6>
            <p style="color: var(--muted); font-size: 0.8rem; margin: 5px 0 0 0;">Bills, Receipts, etc.</p>
          </div>

          <i class="fas fa-arrow-right" style="color: var(--brand-2); font-size: 1.5rem;"></i>

          <div style="background: rgba(0, 229, 255, 0.2); padding: 15px 20px; border-radius: 10px; text-align: center; min-width: 150px;">
            <i class="fas fa-book" style="font-size: 2rem; color: var(--brand-2); margin-bottom: 8px;"></i>
            <h6 style="color: var(--text); margin: 0;">Journal</h6>
            <p style="color: var(--muted); font-size: 0.8rem; margin: 5px 0 0 0;">Recording</p>
          </div>

          <i class="fas fa-arrow-right" style="color: var(--accent); font-size: 1.5rem;"></i>

          <div style="background: rgba(255, 122, 198, 0.2); padding: 15px 20px; border-radius: 10px; text-align: center; min-width: 150px;">
            <i class="fas fa-layer-group" style="font-size: 2rem; color: var(--accent); margin-bottom: 8px;"></i>
            <h6 style="color: var(--text); margin: 0;">Ledger</h6>
            <p style="color: var(--muted); font-size: 0.8rem; margin: 5px 0 0 0;">Classification</p>
          </div>

          <i class="fas fa-arrow-right" style="color: var(--brand); font-size: 1.5rem;"></i>

          <div style="background: rgba(124, 77, 255, 0.2); padding: 15px 20px; border-radius: 10px; text-align: center; min-width: 150px;">
            <i class="fas fa-balance-scale" style="font-size: 2rem; color: var(--brand); margin-bottom: 8px;"></i>
            <h6 style="color: var(--text); margin: 0;">Trial Balance</h6>
            <p style="color: var(--muted); font-size: 0.8rem; margin: 5px 0 0 0;">Summarizing</p>
          </div>

          <i class="fas fa-arrow-right" style="color: var(--brand-2); font-size: 1.5rem;"></i>

          <div style="background: rgba(0, 229, 255, 0.2); padding: 15px 20px; border-radius: 10px; text-align: center; min-width: 150px;">
            <i class="fas fa-chart-line" style="font-size: 2rem; color: var(--brand-2); margin-bottom: 8px;"></i>
            <h6 style="color: var(--text); margin: 0;">Financial Statements</h6>
            <p style="color: var(--muted); font-size: 0.8rem; margin: 5px 0 0 0;">Final Output</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MCQ Section -->
    <section class="animate-card">
      <h2>Multiple Choice Questions</h2>
      <p style="color: var(--muted); line-height: 1.6; margin-bottom: 30px;">
        Test your understanding of the Double Entry System concepts. Complete all questions to see your results.
      </p>

      <div class="mcq-grid" id="mcq-container">
        
        <!-- Question 1 -->
        <div class="mcq" data-answer="b">
          <h3>1. The double entry system was developed by:</h3>
          <input type="radio" name="q1" id="q1a" value="a"><label for="q1a">Leonardo da Vinci</label>
          <input type="radio" name="q1" id="q1b" value="b"><label for="q1b">Luca Pacioli</label>
          <input type="radio" name="q1" id="q1c" value="c"><label for="q1c">Galileo Galilei</label>
          <input type="radio" name="q1" id="q1d" value="d"><label for="q1d">Isaac Newton</label>
        </div>

        <!-- Question 2 -->
        <div class="mcq" data-answer="a">
          <h3>2. In double entry system, every transaction affects:</h3>
          <input type="radio" name="q2" id="q2a" value="a"><label for="q2a">At least two accounts</label>
          <input type="radio" name="q2" id="q2b" value="b"><label for="q2b">Only one account</label>
          <input type="radio" name="q2" id="q2c" value="c"><label for="q2c">Three accounts</label>
          <input type="radio" name="q2" id="q2d" value="d"><label for="q2d">All accounts</label>
        </div>

        <!-- Question 3 -->
        <div class="mcq" data-answer="c">
          <h3>3. Which account follows the rule "Debit the Receiver, Credit the Giver"?</h3>
          <input type="radio" name="q3" id="q3a" value="a"><label for="q3a">Real Account</label>
          <input type="radio" name="q3" id="q3b" value="b"><label for="q3b">Nominal Account</label>
          <input type="radio" name="q3" id="q3c" value="c"><label for="q3c">Personal Account</label>
          <input type="radio" name="q3" id="q3d" value="d"><label for="q3d">All accounts</label>
        </div>

        <!-- Question 4 -->
        <div class="mcq" data-answer="b">
          <h3>4. Rent Account is an example of:</h3>
          <input type="radio" name="q4" id="q4a" value="a"><label for="q4a">Personal Account</label>
          <input type="radio" name="q4" id="q4b" value="b"><label for="q4b">Nominal Account</label>
          <input type="radio" name="q4" id="q4c" value="c"><label for="q4c">Real Account</label>
          <input type="radio" name="q4" id="q4d" value="d"><label for="q4d">None of these</label>
        </div>

        <!-- Question 5 -->
        <div class="mcq" data-answer="a">
          <h3>5. The rule for Real Accounts is:</h3>
          <input type="radio" name="q5" id="q5a" value="a"><label for="q5a">Debit what comes in, Credit what goes out</label>
          <input type="radio" name="q5" id="q5b" value="b"><label for="q5b">Debit the receiver, Credit the giver</label>
          <input type="radio" name="q5" id="q5c" value="c"><label for="q5c">Debit all expenses, Credit all income</label>
          <input type="radio" name="q5" id="q5d" value="d"><label for="q5d">None of these</label>
        </div>

        <!-- Question 6 -->
        <div class="mcq" data-answer="c">
          <h3>6. Bank Account is classified as:</h3>
          <input type="radio" name="q6" id="q6a" value="a"><label for="q6a">Real Account</label>
          <input type="radio" name="q6" id="q6b" value="b"><label for="q6b">Nominal Account</label>
          <input type="radio" name="q6" id="q6c" value="c"><label for="q6c">Personal Account</label>
          <input type="radio" name="q6" id="q6d" value="d"><label for="q6d">Mixed Account</label>
        </div>

        <!-- Question 7 -->
        <div class="mcq" data-answer="a">
          <h3>7. The first stage of double entry system is:</h3>
          <input type="radio" name="q7" id="q7a" value="a"><label for="q7a">Recording</label>
          <input type="radio" name="q7" id="q7b" value="b"><label for="q7b">Classification</label>
          <input type="radio" name="q7" id="q7c" value="c"><label for="q7c">Summarizing</label>
          <input type="radio" name="q7" id="q7d" value="d"><label for="q7d">Analysis</label>
        </div>

        <!-- Question 8 -->
        <div class="mcq" data-answer="b">
          <h3>8. Capital Account is an example of:</h3>
          <input type="radio" name="q8" id="q8a" value="a"><label for="q8a">Real Account</label>
          <input type="radio" name="q8" id="q8b" value="b"><label for="q8b">Personal Account</label>
          <input type="radio" name="q8" id="q8c" value="c"><label for="q8c">Nominal Account</label>
          <input type="radio" name="q8" id="q8d" value="d"><label for="q8d">Asset Account</label>
        </div>

        <!-- Question 9 -->
        <div class="mcq" data-answer="c">
          <h3>9. Sales Account follows which rule?</h3>
          <input type="radio" name="q9" id="q9a" value="a"><label for="q9a">Debit what comes in</label>
          <input type="radio" name="q9" id="q9b" value="b"><label for="q9b">Debit the receiver</label>
          <input type="radio" name="q9" id="q9c" value="c"><label for="q9c">Credit all income</label>
          <input type="radio" name="q9" id="q9d" value="d"><label for="q9d">Debit all expenses</label>
        </div>

        <!-- Question 10 -->
        <div class="mcq" data-answer="a">
          <h3>10. In double entry system, total debits must equal:</h3>
          <input type="radio" name="q10" id="q10a" value="a"><label for="q10a">Total credits</label>
          <input type="radio" name="q10" id="q10b" value="b"><label for="q10b">Total assets</label>
          <input type="radio" name="q10" id="q10c" value="c"><label for="q10c">Total liabilities</label>
          <input type="radio" name="q10" id="q10d" value="d"><label for="q10d">Total capital</label>
        </div>
      </div>

      <!-- ✅ CHANGED: Added onclick handler -->
      <button id="submitQuiz" onclick="submitQuiz()">Submit Answers</button>
      <div id="quizResult"></div>
      
      <!-- ✅ CHANGED: Added onclick and style -->
      <button id="retry-btn" onclick="retryQuiz()" style="display:none;">Try Again</button>
    </section>

    <!-- Classification Questions -->
    <section class="animate-card">
      <h2>Classification Practice Questions</h2>
      <p style="color: var(--muted); line-height: 1.6; margin-bottom: 25px;">
        Practice classifying different accounts into Personal, Real, and Nominal categories.
      </p>

      <div class="example-card animate-card">
        <h4 style="color: var(--brand); margin: 0 0 20px 0;">Additional Accounts to Classify</h4>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
          
          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Insurance Account</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Nominal</p>
          </div>

          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Suresh (Creditor)</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Personal</p>
          </div>

          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Land Account</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Real</p>
          </div>

          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Commission Received</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Nominal</p>
          </div>

          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Drawings Account</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Personal</p>
          </div>

          <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
            <h6 style="color: var(--text); margin: 0 0 10px 0;">Stock Account</h6>
            <p style="color: var(--muted); font-size: 0.9rem; margin: 0;">Type: Real</p>
          </div>
        </div>
      </div>
    </section>

  </main>

  <script type="module">
    // ========================================
    // 1. IMPORT FIREBASE (ONLY THIS LINE NEEDS EXTERNAL FILE)
    // ========================================
    import { submitLessonAttempt, loadPreviousAnswers } from '../firebase-config.js';

    // ========================================
    // 2. CONFIGURATION (CHANGE FOR EACH LESSON)
    // ========================================
    const LESSON_NUMBER = '1';  // ← Change this: '1', '2', '3', etc.
    const LESSON_ID = 'lesson-1'; // ← Change this: 'lesson-1', 'lesson-2', etc.

    // ========================================
    // 3. INITIALIZE QUIZ
    // ========================================
    function initQuiz() {
      console.log('🎯 Initializing quiz for Lesson', LESSON_NUMBER);
      
      const container = document.getElementById('quiz-container');
      if (!container) {
        console.error('❌ Quiz container not found');
        return;
      }

      // Add event listeners to all radio buttons
      const allInputs = container.querySelectorAll('input[type="radio"]');
      allInputs.forEach(input => {
        // UPDATE PROGRESS BAR ON CHANGE
        input.addEventListener('change', updateProgressBar);
        
        // ✨ ADD UNCLICK FUNCTIONALITY ✨
        input.addEventListener('click', function(e) {
          // If already checked, uncheck it
          if (this.dataset.checked === 'true') {
            this.checked = false;
            this.dataset.checked = 'false';
            updateProgressBar(); // Update progress after unclick
          } else {
            // Mark all radios in this group as unchecked
            const groupName = this.name;
            document.querySelectorAll(`input[name="${groupName}"]`).forEach(radio => {
              radio.dataset.checked = 'false';
            });
            // Mark this one as checked
            this.dataset.checked = 'true';
          }
        });
      });

      console.log('✅ Quiz initialized with', allInputs.length, 'options');
      updateProgressBar();
    }

    // ========================================
    // 4. UPDATE PROGRESS BAR (REAL-TIME)
    // ========================================
    function updateProgressBar() {
      const container = document.getElementById('quiz-container');
      if (!container) return;

      // Count total questions
      const allQuestions = container.querySelectorAll('.mcq');
      const totalQuestions = allQuestions.length;

      // Count answered questions
      let answeredCount = 0;
      allQuestions.forEach(mcq => {
        const questionName = mcq.querySelector('input[type="radio"]').name;
        const selected = document.querySelector(`input[name="${questionName}"]:checked`);
        if (selected) answeredCount++;
      });

      // Calculate progress percentage
      const progressPercentage = totalQuestions > 0 ? Math.round((answeredCount / totalQuestions) * 100) : 0;

      // Update progress bar UI
      const progressDiv = document.getElementById('quiz-progress');
      if (progressDiv) {
        progressDiv.innerHTML = `
          <div style="margin-bottom: 20px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px; color: var(--muted);">
              <span>Questions Answered</span>
              <span><strong style="color: var(--brand-2);">${answeredCount}/${totalQuestions}</strong></span>
            </div>
            <div style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
              <div style="width: ${progressPercentage}%; height: 100%; background: linear-gradient(90deg, var(--brand), var(--brand-2)); transition: width 0.3s ease;"></div>
            </div>
          </div>
        `;
      }

      console.log(`📊 Progress: ${answeredCount}/${totalQuestions} (${progressPercentage}%)`);
    }

    // ========================================
    // 5. SUBMIT QUIZ (BULLETPROOF VERSION)
    // ========================================
    window.submitQuiz = async function() {
      console.log('📤 Submitting quiz for Lesson', LESSON_NUMBER);
      
      const container = document.getElementById('quiz-container');
      if (!container) return;

      const mcqs = container.querySelectorAll('.mcq');
      if (mcqs.length === 0) return;

      let answersData = {};
      let correctCount = 0;
      let totalQuestions = mcqs.length;
      let answeredCount = 0;

      mcqs.forEach((mcq, index) => {
        const correctAnswer = mcq.dataset.answer;
        const questionNumber = `q${index + 1}`;
        const inputs = mcq.querySelectorAll('input[type="radio"]');
        const questionName = inputs[0].name;
        const selected = document.querySelector(`input[name="${questionName}"]:checked`);

        if (!selected) return;

        answeredCount++;
        const selectedValue = selected.value;
        const isCorrect = selectedValue === correctAnswer;
        if (isCorrect) correctCount++;

        answersData[questionNumber] = {
          selected: selectedValue,
          correct: correctAnswer,
          isCorrect: isCorrect
        };

        inputs.forEach(input => {
          const label = input.nextElementSibling;
          if (!label) return;
          input.disabled = true;
          if (input.value === correctAnswer) {
            label.style.background = 'linear-gradient(90deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1))';
            label.style.borderLeft = '4px solid #10b981';
            label.style.fontWeight = 'bold';
          }
          if (input.value === selectedValue && !isCorrect) {
            label.style.background = 'linear-gradient(90deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1))';
            label.style.borderLeft = '4px solid #ef4444';
          }
        });
      });

      if (answeredCount === 0) {
        alert('⚠️ Please answer at least 1 question before submitting!');
        return;
      }

      const percentage = Math.round((correctCount / totalQuestions) * 100);
      const submitBtn = document.getElementById('submitQuiz');
      const resultDiv = document.getElementById('quizResult');

      if (submitBtn) {
        submitBtn.disabled = true;
        submitBtn.textContent = 'Submitting...';
      }

      // Show loading state
      if (resultDiv) {
        resultDiv.innerHTML = `
          <div style="padding: 20px; margin-top: 20px; background: rgba(124,77,255,0.1); border-radius: 12px; text-align: center;">
            <div style="font-size: 1.2rem; color: var(--brand-2);">⚙️ Saving your progress...</div>
          </div>`;
      }

      try {
        console.log("📤 Submitting to Firebase:", { lessonNumber: LESSON_NUMBER, correctCount, totalQuestions, percentage });
        const result = await submitLessonAttempt(LESSON_NUMBER, answersData, correctCount, totalQuestions);
        console.log("✅ Firebase response:", result);

        // ALWAYS show result, even if Firebase fails
        if (resultDiv) {
          if (result && result.success) {
            if (result.updated) {
              // New best score!
              resultDiv.innerHTML = `
                <div style="padding: 20px; margin-top: 20px; background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1)); border-radius: 12px; border: 2px solid #10b981;">
                  <div style="font-size: 1.5rem; font-weight: bold; color: #10b981; margin-bottom: 10px;">🎉 New Best Score!</div>
                  <div style="font-size: 1.2rem; margin-bottom: 10px;">You scored: <strong>${correctCount}/${totalQuestions}</strong> (${percentage}%)</div>
                  <div style="color: var(--muted); font-size: 0.9rem;">✅ Answered ${answeredCount} out of ${totalQuestions} questions</div>
                  <div style="color: var(--muted); font-size: 0.85rem; margin-top: 10px;">✅ Progress saved to cloud</div>
                </div>`;
            } else {
              // Previous score was better
              resultDiv.innerHTML = `
                <div style="padding: 20px; margin-top: 20px; background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(251, 191, 36, 0.1)); border-radius: 12px; border: 2px solid #fbbf24;">
                  <div style="font-size: 1.5rem; font-weight: bold; color: #fbbf24; margin-bottom: 10px;">📊 Quiz Completed</div>
                  <div style="font-size: 1.2rem; margin-bottom: 10px;">Current Score: <strong>${correctCount}/${totalQuestions}</strong> (${percentage}%)</div>
                  <div style="font-size: 1.1rem; margin-bottom: 10px; color: #10b981;">Your Best: <strong>${result.bestScore}/${result.totalQuestions}</strong> (${result.percentage}%)</div>
                  <div style="color: var(--muted); font-size: 0.9rem;">Answered ${answeredCount} out of ${totalQuestions} questions</div>
                  <div style="color: var(--muted); font-size: 0.85rem; margin-top: 10px;">💡 Try again to beat your best score!</div>
                </div>`;
            }
          } else {
            // Firebase failed but still show score
            resultDiv.innerHTML = `
              <div style="padding: 20px; margin-top: 20px; background: linear-gradient(135deg, rgba(124,77,255,0.2), rgba(124,77,255,0.1)); border-radius: 12px; border: 2px solid var(--brand);">
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--brand-2); margin-bottom: 10px;">📊 Your Score</div>
                <div style="font-size: 1.2rem; margin-bottom: 10px;">You scored: <strong>${correctCount}/${totalQuestions}</strong> (${percentage}%)</div>
                <div style="color: var(--muted); font-size: 0.9rem;">✅ Answered ${answeredCount} out of ${totalQuestions} questions</div>
                <div style="color: #fbbf24; font-size: 0.85rem; margin-top: 10px;">⚠️ Could not save to cloud. Check console (F12) for details.</div>
              </div>`;
            console.error("❌ Firebase error:", result?.error || "Unknown error");
          }
        }
      } catch (error) {
        console.error("❌ Critical error during submission:", error);
        // STILL show the score even if everything fails
        if (resultDiv) {
          resultDiv.innerHTML = `
            <div style="padding: 20px; margin-top: 20px; background: linear-gradient(135deg, rgba(124,77,255,0.2), rgba(124,77,255,0.1)); border-radius: 12px; border: 2px solid var(--brand);">
              <div style="font-size: 1.5rem; font-weight: bold; color: var(--brand-2); margin-bottom: 10px;">📊 Your Score</div>
              <div style="font-size: 1.2rem; margin-bottom: 10px;">You scored: <strong>${correctCount}/${totalQuestions}</strong> (${percentage}%)</div>
              <div style="color: var(--muted); font-size: 0.9rem;">✅ Answered ${answeredCount} out of ${totalQuestions} questions</div>
              <div style="color: #ef4444; font-size: 0.85rem; margin-top: 10px;">❌ Error: ${error.message}</div>
              <div style="color: var(--muted); font-size: 0.8rem; margin-top: 5px;">Check browser console (F12) for details</div>
            </div>`;
        }
      } finally {
        // Always show retry button and update submit button
        const retryBtn = document.getElementById('retry-btn');
        if (retryBtn) retryBtn.style.display = 'block';
        if (submitBtn) {
          submitBtn.disabled = true;
          submitBtn.textContent = '✓ Submitted';
        }
      }
    };

    // ========================================
    // 6. RETRY QUIZ
    // ========================================
    window.retryQuiz = function() {
      console.log('🔄 Retrying quiz');
      
      const container = document.getElementById('quiz-container');
      if (!container) return;

      // Reset all inputs
      const allInputs = container.querySelectorAll('input[type="radio"]');
      allInputs.forEach(input => {
        input.checked = false;
        input.disabled = false;
        input.dataset.checked = 'false'; // Reset unclick tracking
        
        const label = input.nextElementSibling;
        if (label) {
          label.style.background = '';
          label.style.borderLeft = '';
          label.style.fontWeight = '';
        }
      });

      // Reset UI
      const resultDiv = document.getElementById('quizResult');
      if (resultDiv) resultDiv.innerHTML = '';

      const submitBtn = document.getElementById('submitQuiz');
      if (submitBtn) {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Answers';
      }

      const retryBtn = document.getElementById('retry-btn');
      if (retryBtn) retryBtn.style.display = 'none';

      updateProgressBar();
      document.getElementById('mcqSection')?.scrollIntoView({ behavior: 'smooth' });
    };

    // ========================================
    // 7. INITIALIZE ON PAGE LOAD
    // ========================================
    initQuiz();
    console.log('✅ Lesson', LESSON_NUMBER, 'quiz ready!');
    
(() => {
  // ======================================================
  // 1. SELECTORS
  // ======================================================
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));

  // ======================================================
  // 2. ANIMATION CSS INJECTION
  // ======================================================
  const css = `
    @keyframes shakeX {
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-8px)}
      40%{transform:translateX(8px)}
      60%{transform:translateX(-6px)}
      80%{transform:translateX(6px)}
    }
    .aw-shake{animation:shakeX 0.4s ease}
    .aw-pop{animation:popIn 0.35s ease both}
    @keyframes popIn {
      0%{opacity:0;transform:translateY(10px) scale(.96)}
      60%{opacity:1;transform:translateY(-4px) scale(1.02)}
      100%{opacity:1;transform:translateY(0) scale(1)}
    }
  `;
  const st = document.createElement("style");
  st.textContent = css;
  document.head.appendChild(st);

  // ======================================================
  // 3. CARD ANIMATION SYSTEM
  // ======================================================
  class CardAnimator {
    constructor() {
      this.observer = null;
      this.init();
    }

    init() {
      setTimeout(() => {
        this.addAnimationClasses();
        this.setupObserver();
        this.animateOnLoad();
      }, 100);
    }

    addAnimationClasses() {
      // Main account type cards
      $$('.account-type').forEach(card => {
        card.classList.add('animate-card', 'equation-card');
      });

      // Principle cards
      $$('.principle-card').forEach(card => {
        card.classList.add('animate-card', 'process-card');
      });

      // Stage cards
      $$('.stage-card').forEach(card => {
        card.classList.add('animate-card', 'process-card');
      });

      // Example cards
      $$('.example-card').forEach(card => {
        card.classList.add('animate-card', 'process-card');
      });
    }

    setupObserver() {
      const options = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
      this.observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            this.observer.unobserve(entry.target);
          }
        });
      }, options);

      $$('.animate-card').forEach(card => this.observer.observe(card));
    }

    animateOnLoad() {
      setTimeout(() => {
        const introSection = $('section:first-of-type');
        if (introSection) {
          introSection.querySelectorAll('.animate-card').forEach(card => {
            card.classList.add('visible');
          });
        }
      }, 300);

      setTimeout(() => {
        $$('.animate-card').forEach(card => {
          const rect = card.getBoundingClientRect();
          if (rect.top < window.innerHeight && rect.bottom > 0) {
            card.classList.add('visible');
          }
        });
      }, 600);
    }
  }

  // ======================================================
  // 4. ENHANCED HOVER EFFECTS
  // ======================================================
  function addHoverEffects() {
    $$('.animate-card').forEach(card => {
      card.addEventListener('mouseenter', () => {
        card.style.transition = 'all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)';
        const colors = ['var(--brand)', 'var(--brand-2)', 'var(--accent)'];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        card.style.boxShadow = `0 25px 50px rgba(2,6,23,.8), 0 0 30px ${randomColor}40`;
      });

      card.addEventListener('mouseleave', () => {
        card.style.boxShadow = 'var(--shadow)';
      });
    });
  }

  // ======================================================
  // 5. TERM CARD TOGGLE FUNCTION
  // ======================================================
  window.toggleTerm = function(card) {
    const details = card.querySelector('.term-details');
    const indicator = card.querySelector('.term-indicator');

    if (details.style.maxHeight === '0px' || !details.style.maxHeight) {
      // Close other cards
      $$('.term-card').forEach(otherCard => {
        if (otherCard !== card) {
          otherCard.querySelector('.term-details').style.maxHeight = '0px';
          otherCard.querySelector('.term-indicator').style.transform = 'scaleX(0)';
          otherCard.style.background = 'var(--card)';
        }
      });

      // Open this card
      details.style.maxHeight = details.scrollHeight + 'px';
      indicator.style.transform = 'scaleX(1)';
      card.style.background = 'linear-gradient(145deg, var(--card), rgba(255,255,255,0.05))';
    } else {
      // Close this card
      details.style.maxHeight = '0px';
      indicator.style.transform = 'scaleX(0)';
      card.style.background = 'var(--card)';
    }
  };

  // ======================================================
  // 6. EMERGENCY CONTENT FIX (VISIBILITY)
  // ======================================================
  window.addEventListener('load', () => {
    setTimeout(() => {
      $$('h3, p, ul, li, div').forEach(el => {
        if (!el.classList.contains('term-details') && getComputedStyle(el).opacity === '0') {
          el.style.opacity = '1';
          el.style.visibility = 'visible';
        }
      });
    }, 1000);
  });

  // ======================================================
  // 7. INITIALIZE EVERYTHING
  // ======================================================
  function initialize() {
    new CardAnimator();
    addHoverEffects();
    console.log('Chapter 7 - Double Entry System (animations only) loaded successfully!');
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initialize);
  } else {
    initialize();
  }
})();
</script>
</body>
</html>